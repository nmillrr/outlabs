# Progress Log

## Learnings
(Patterns discovered during implementation)

---

## Iteration 1 - US-001: Create project structure and dependencies
- Created `freeT/` package with `__init__.py`, `models.py`, `utils.py`, `data.py`
- Created `tests/` directory with `test_models.py`
- Created `notebooks/` directory with `.gitkeep`
- Created `requirements.txt` with all dependencies
- All Python files pass syntax check (`py_compile`)
- Learnings for future iterations:
  - Use PowerShell semicolon (`;`) not `&&` for command chaining on Windows
  - Package init imports submodules for easier access
---

## Iteration 2 - US-002: Implement unit conversion utilities
- Implemented 4 conversion functions in `freeT/utils.py`:
  - `ng_dl_to_nmol_l()` - testosterone ng/dL to nmol/L (factor: 0.0347)
  - `nmol_l_to_ng_dl()` - reverse conversion
  - `mg_dl_to_g_l()` - albumin mg/dL to g/L (factor: 0.01)
  - `g_l_to_mg_dl()` - reverse conversion
- Created `tests/test_utils.py` with 9 test cases covering typical values, edge cases, and roundtrip consistency
- All tests pass via `python -m pytest tests/test_utils.py -v`
- Learnings for future iterations:
  - Use `python -m pytest` instead of `pytest` when pytest isn't in PATH
  - Testosterone conversion factor 0.0347 derived from MW 288.4 g/mol
---

## Iteration 3 - US-003: Create NHANES download module
- Implemented `download_nhanes()` function in `freeT/data.py`
- Function downloads TST, SHBG, ALB XPT files from CDC NHANES website
- Supports cycles 2011-2012, 2013-2014, 2015-2016
- Creates directory structure automatically: `data/raw/{cycle}/`
- Handles HTTP errors, URL errors, and unexpected exceptions gracefully
- Returns summary dict with downloaded/failed/skipped files
- Typecheck passes via `py_compile`
- Learnings for future iterations:
  - NHANES data uses XPT (SAS transport) format
  - Albumin data is in BIOPRO (biochemistry profile) files, not a separate ALB file
  - Use `urllib.request.urlretrieve` for simple file downloads
---
